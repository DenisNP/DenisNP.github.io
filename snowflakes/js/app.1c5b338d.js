(function(t){function e(e){for(var r,o,s=e[0],u=e[1],c=e[2],h=0,f=[];h<s.length;h++)o=s[h],Object.prototype.hasOwnProperty.call(a,o)&&a[o]&&f.push(a[o][0]),a[o]=0;for(r in u)Object.prototype.hasOwnProperty.call(u,r)&&(t[r]=u[r]);l&&l(e);while(f.length)f.shift()();return i.push.apply(i,c||[]),n()}function n(){for(var t,e=0;e<i.length;e++){for(var n=i[e],r=!0,o=1;o<n.length;o++){var u=n[o];0!==a[u]&&(r=!1)}r&&(i.splice(e--,1),t=s(s.s=n[0]))}return t}var r={},a={app:0},i=[];function o(t){return s.p+"js/"+({}[t]||t)+"."+{"chunk-1bfaad5a":"9fcf989f","chunk-2d216214":"a631c492","chunk-2d216257":"d8c9bc89"}[t]+".js"}function s(e){if(r[e])return r[e].exports;var n=r[e]={i:e,l:!1,exports:{}};return t[e].call(n.exports,n,n.exports,s),n.l=!0,n.exports}s.e=function(t){var e=[],n=a[t];if(0!==n)if(n)e.push(n[2]);else{var r=new Promise((function(e,r){n=a[t]=[e,r]}));e.push(n[2]=r);var i,u=document.createElement("script");u.charset="utf-8",u.timeout=120,s.nc&&u.setAttribute("nonce",s.nc),u.src=o(t);var c=new Error;i=function(e){u.onerror=u.onload=null,clearTimeout(h);var n=a[t];if(0!==n){if(n){var r=e&&("load"===e.type?"missing":e.type),i=e&&e.target&&e.target.src;c.message="Loading chunk "+t+" failed.\n("+r+": "+i+")",c.name="ChunkLoadError",c.type=r,c.request=i,n[1](c)}a[t]=void 0}};var h=setTimeout((function(){i({type:"timeout",target:u})}),12e4);u.onerror=u.onload=i,document.head.appendChild(u)}return Promise.all(e)},s.m=t,s.c=r,s.d=function(t,e,n){s.o(t,e)||Object.defineProperty(t,e,{enumerable:!0,get:n})},s.r=function(t){"undefined"!==typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(t,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(t,"__esModule",{value:!0})},s.t=function(t,e){if(1&e&&(t=s(t)),8&e)return t;if(4&e&&"object"===typeof t&&t&&t.__esModule)return t;var n=Object.create(null);if(s.r(n),Object.defineProperty(n,"default",{enumerable:!0,value:t}),2&e&&"string"!=typeof t)for(var r in t)s.d(n,r,function(e){return t[e]}.bind(null,r));return n},s.n=function(t){var e=t&&t.__esModule?function(){return t["default"]}:function(){return t};return s.d(e,"a",e),e},s.o=function(t,e){return Object.prototype.hasOwnProperty.call(t,e)},s.p="/",s.oe=function(t){throw console.error(t),t};var u=window["webpackJsonp"]=window["webpackJsonp"]||[],c=u.push.bind(u);u.push=e,u=u.slice();for(var h=0;h<u.length;h++)e(u[h]);var l=c;i.push([0,"chunk-vendors"]),n()})({0:function(t,e,n){t.exports=n("cd49")},"034f":function(t,e,n){"use strict";n("85ec")},"85ec":function(t,e,n){},cd49:function(t,e,n){"use strict";n.r(e);n("e260"),n("e6cf"),n("cca6"),n("a79d");var r,a,i,o,s,u,c,h,l,f,d,v,p,g,m,y,w,b,M,x,k,O,j,P,S,R=n("2b0e"),T=function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("div",{attrs:{id:"app"}},[n("div",{staticClass:"buttons-block"},[n("input",{directives:[{name:"model",rawName:"v-model",value:t.cutoutsRatio,expression:"cutoutsRatio"}],attrs:{type:"range",min:"0.5",max:"9",step:"0.1"},domProps:{value:t.cutoutsRatio},on:{__r:function(e){t.cutoutsRatio=e.target.value}}}),n("span",[t._v(t._s(t.cutoutsRatio))]),n("button",{on:{click:function(){return t.generate()}}},[t._v("Generate")]),n("button",{on:{click:function(){return t.generateImage()}}},[t._v("Get PDF")])]),n("div",{staticClass:"canvas-block"},[n("canvas",{key:"cv",attrs:{id:"canvas"}}),n("canvas",{key:"cf",attrs:{id:"cFinal"}})]),n("canvas",{key:"ci",attrs:{id:"imageCanvas",width:"2100",height:"2970"}})])},E=[],I=(n("a9e3"),n("cb29"),n("8baf")),C=n("2909"),L=(n("a434"),n("d81d"),n("99af"),n("159b"),n("d4ec")),_=n("bee2"),A=function(){function t(e,n){Object(L["a"])(this,t),this.start=e,this.end=n}return Object(_["a"])(t,[{key:"xLen",get:function(){return this.end.x-this.start.x}},{key:"yLen",get:function(){return this.end.y-this.start.y}},{key:"len",get:function(){return Math.sqrt(Math.pow(this.xLen,2)+Math.pow(this.yLen,2))}},{key:"ang",get:function(){return Math.atan2(this.end.y-this.start.y,this.end.x-this.start.x)}},{key:"angDeg",get:function(){return this.ang*(180/Math.PI)}},{key:"revAng",get:function(){return Math.atan2(this.start.y-this.end.y,this.start.x-this.end.x)}},{key:"revAngDeg",get:function(){return this.revAng*(180/Math.PI)}},{key:"distanceToPoint",value:function(t){var e,n,r=t.x-this.start.x,a=t.y-this.start.y,i=this.xLen,o=this.yLen,s=r*i+a*o,u=i*i+o*o,c=-1;0!==u&&(c=s/u),c<0?(e=this.start.x,n=this.start.y):c>1?(e=this.end.x,n=this.end.y):(e=this.start.x+c*i,n=this.start.y+c*o);var h=t.x-e,l=t.y-n;return Math.sqrt(h*h+l*l)}}]),t}(),D=n("6b47"),q=function(){function t(e,n){Object(L["a"])(this,t),this.x=e,this.y=n}return Object(_["a"])(t,[{key:"equals",value:function(t){return this.x===t.x&&this.y===t.y}}]),t}(),B=function(t,e){return Math.random()*(e-t)+t},X=function(t,e){return Math.sqrt(Math.pow(t.x-e.x,2)+Math.pow(t.y-e.y,2))},N=function(t){return Math.random()<t},F=function(t,e){var n=t.xLen,r=t.yLen,a=e*n,i=e*r;return new q(t.start.x+a,t.start.y+i)},U=function(t,e){var n=t.len,r=e/n,a=1-r;return new A(F(t,r),F(t,a))},W=function(t,e){var n=Object(D["a"])(t.start.x,t.start.y,t.end.x,t.end.y,e.start.x,e.start.y,e.end.x,e.end.y);return n.point?new q(n.point.x,n.point.y):null},z=function(){var t=arguments.length>0&&void 0!==arguments[0]&&arguments[0];if(r&&!t)return r;var e=document.getElementById("canvas");return r=e.getContext("2d"),r},V=function(t,e,n){var r=X(t,e),a=X(e,n),i=X(n,t),o=(r+a+i)/2;return Math.sqrt(o*(o-1)*(o-a)*(o-i))},Y=function(t,e){var n=e.x-t.x,r=e.y-t.y,a=Math.random();return new q(t.x+n*a,t.y+r*a)},$=function(t,e){var n=U(t,e);return Y(n.start,n.end)},G=function(t,e,n){var r=new q(t.x+n*Math.cos(e),t.y+n*Math.sin(e));return new A(t,r)},H=Math.PI/180,J=45,K=15,Q=.1,Z=.25,tt=.5,et=.3,nt=.8,rt=function(t,e){a=t,i=e,o=new A(a.end,i.start)},at=function(){if(N(Q)){var t=F(i,B(Z,tt));return[new A(a.end,t)]}var e=a.revAngDeg-B(K,J),n=o.len*B(et,nt),r=G(a.end,e*H,n),s=G(a.end,e*H,a.len),u=W(i,s),c=new A(r.end,Y(i.start,u));return[r,c]},it=(n("4de4"),n("0481"),function(){function t(e){Object(L["a"])(this,t),this.points=e}return Object(_["a"])(t,[{key:"storeCanvasRect",value:function(){var t=z(),e=this.points.map((function(t){return t.x})),n=this.points.map((function(t){return t.y})),r=Math.min.apply(Math,Object(C["a"])(e)),a=Math.min.apply(Math,Object(C["a"])(n)),i=20,o=Math.max.apply(Math,Object(C["a"])(e))-r,s=Math.max.apply(Math,Object(C["a"])(n))-a;this.storedRectX=r-i,this.storedRectY=a-i,this.storedRect=t.getImageData(this.storedRectX,this.storedRectY,o+2*i,s+2*i)}},{key:"restoreCanvasRect",value:function(){var t=z();t.putImageData(this.storedRect,this.storedRectX,this.storedRectY)}},{key:"draw",value:function(){var t=z();t.lineWidth=4,t.setLineDash([15,15]),t.strokeStyle="#ff0000",t.beginPath(),t.moveTo(this.points[0].x,this.points[0].y);for(var e=1;e<this.points.length-1;e++)t.lineTo(this.points[e].x,this.points[e].y);t.stroke()}},{key:"cut",value:function(){var t=z();t.globalCompositeOperation="destination-out",t.setLineDash([]),t.lineWidth=1,t.beginPath(),t.moveTo(this.points[0].x,this.points[0].y);for(var e=1;e<this.points.length;e++)t.lineTo(this.points[e].x,this.points[e].y);t.closePath(),t.fill(),t.stroke(),t.globalCompositeOperation="source-over"}}]),t}()),ot=function(){function t(e,n,r){Object(L["a"])(this,t),this.sideSeg=e,this.firstSeg=n,this.secondSeg=r}return Object(_["a"])(t,[{key:"square",get:function(){return V(this.sideSeg.start,this.sideSeg.end,this.firstSeg.end)}},{key:"points",get:function(){return[this.sideSeg.start,this.firstSeg.end,this.sideSeg.end,this.sideSeg.start]}},{key:"toCutoutStep",value:function(){return new it(this.points)}}]),t}(),st=60,ut=function(t){var e=t.filter((function(t){return t.len>=2*s+h}));if(0===e.length)return-1;for(var n=e.reduce((function(t,e){var n=e.len;return t+n}),0),r=B(0,n),a=0,i=0;i<e.length;i++)if(a+=e[i].len,r<=a)return t.indexOf(e[i]);return-1},ct=function(t,e){var n=Number.MAX_VALUE;return t.forEach((function(t){var r=W(t,e);if(null!==r){var a=X(r,e.start);a<n&&(n=a)}})),n},ht=function(t,e){return Math.min.apply(Math,Object(C["a"])(t.map((function(t){return t.distanceToPoint(e)}))))},lt=function(t,e){return Math.min.apply(Math,Object(C["a"])(e.map((function(e){return t.distanceToPoint(e)}))))},ft=function(t,e,n){var r=Math.pow(t,.5),a=Math.pow(t,.25);s=.08*e/r,u=2*s/a,c=s/a,h=.1*e/t,l=.5*e/Math.max(1,a),d=e*e*.04/t,v=e*e*.1/Math.max(1,a),g=2*n,f=h/2,p=5*Math.max(1,t)},dt=function(t,e){var n=ut(t);if(-1===n)return null;for(var r=t[n],a=$(r,s+h/2),i=Math.min(X(a,r.start),X(a,r.end)),o=B(h/2,Math.min(i-s,l/2)),m=r.angDeg,y=m+90,w=B(y-st,y+st),b=G(a,m*H,o),M=G(a,(m+180)*H,o),x=new A(M.end,b.end),k=x.len,O=t.filter((function(t){return t!==r})).concat(e.map((function(t){return[t.firstSeg,t.secondSeg]})).flat()),j=Math.ceil(2*k/h),P=k/j,S=Number.MAX_VALUE,R=0;R<j;R++){var T=F(x,R*P/k),E=G(T,w*H,g),I=ct(O,E);I<S&&(S=I)}if(S>g)return null;S-=u,S=Math.min(S,v/o,p*o*2);var C=Math.max(f,d/o);if(S<C)return null;var L=!1,_=B(C,S),D=G(a,w*H,_),q=null,N=null;while(!L){if(_<C)return null;var U=D.end,W=ht(O,U);if(W<c)_-=c,D=G(a,w*H,_);else{var z=t.filter((function(t){return t!==r})).map((function(t){return[t.start,t.end]})).flat().concat(e.map((function(t){return t.firstSeg.end})));q=new A(x.end,D.end),N=new A(x.start,D.end);var V=Math.min(lt(q,z),lt(N,z));V<c?(_-=c,D=G(a,w*H,_)):L=!0}}q=q||new A(x.end,D.end),N=N||new A(x.start,D.end),t.splice(n,1);var Y=new A(r.start,x.start),J=new A(x.end,r.end);t.splice(n,0,Y,J);var K=new ot(x,q,N);return e.push(K),K};function vt(){var t=document.getElementById("canvas"),e=document.getElementById("cFinal"),n=e.getContext("2d");n.resetTransform(),n.clearRect(0,0,e.width,e.height);var r=t.width,a=t.height,i=Math.sqrt(Math.pow(r/2,2)+Math.pow(a,2)),o=e.width/(2*i);n.scale(o,o),n.translate(e.width/(2*o),e.height/(2*o));var s=[100,97,93,100,97,100,97,90,97,93,97,93];n.rotate(-45*H);for(var u=0;u<6;u++)n.filter="brightness(".concat(s[2*u],"%)"),n.rotate(60*H),n.drawImage(t,-r/2,-a);n.scale(-1,1),n.rotate(-90*H);for(var c=0;c<6;c++)n.filter="brightness(".concat(s[11-2*c],"%)"),n.rotate(60*H),n.drawImage(t,-r/2,-a)}var pt,gt,mt=[],yt=[],wt=[],bt=[],Mt=!1,xt=function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:40,e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:50;y=t,w=e;var n=document.getElementById("canvas"),r=2*document.documentElement.clientHeight;M=r-2*y-2*w,b=2*M*Math.tan(.08333*Math.PI),n.width=b,n.height=M},kt=function(){var t=0,e=0;m.fillStyle="#ffffff",m.beginPath(),m.moveTo(t,e),m.lineTo(t+b,e),m.lineTo(b/2,e+M),m.closePath(),m.fill(),x=new A(new q(b/2,e+M),new q(t,e)),k=new A(new q(t+b,e),new q(b/2,e+M)),rt(x,k),ft(gt,b,Math.max(b,M))},Ot=function(){mt.splice(0),yt.splice(0),wt.splice(0),bt.splice(0)},jt=function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:1,e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:1,n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:Number.MAX_VALUE,r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:10,a=arguments.length>4&&void 0!==arguments[4]?arguments[4]:5e3;m=z(!0),m.resetTransform(),m.clearRect(0,0,b,M),gt=t,O=e,j=n,P=r,S=a,Mt=!1,Ot(),kt()},Pt=function(){var t=P;while((yt.length<O||yt.length>j)&&t-- >0){Ot(),mt.push(new A(x.start,x.end),new A(k.start,k.end));var e=at(),n=e.map((function(t){return t.start}));n.push(e[e.length-1].end,k.start),wt.push(new it(n)),mt[mt.length-1].start=e[e.length-1].end,mt.splice.apply(mt,[1,0].concat(Object(C["a"])(e)));var r=S;while(r-- >0&&mt.length>0){var a=dt(mt,yt);null!==a&&(r=S,wt.push(a.toCutoutStep()))}pt=wt.length}},St=function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:1;bt.forEach((function(t){return t.restoreCanvasRect()}));while(bt.length>0)bt.shift().cut();if(0===wt.length)return Mt?-2:(vt(),Mt=!0,-1);if(pt===wt.length){var e=wt.shift();return e.storeCanvasRect(),e.draw(),bt.push(e),0}var n=wt.splice(0,t);return n.forEach((function(t){return t.storeCanvasRect()})),n.forEach((function(t){return t.draw()})),bt.push.apply(bt,Object(C["a"])(n)),n.length},Rt=R["a"].extend({name:"App",data:function(){return{topMargin:40,bottomMargin:50,sideMargin:20,cutoutsRatio:1.7,triangleData:null}},mounted:function(){var t=this;this.setSizes(),this.$nextTick((function(){t.generate()}))},methods:{setSizes:function(){var t=2*Math.min(document.documentElement.clientWidth-2*this.sideMargin,document.documentElement.clientHeight-this.topMargin-this.bottomMargin),e=document.getElementById("cFinal");e.width=t,e.height=t;var n=document.getElementById("canvas");xt(this.topMargin,this.bottomMargin);var r=document.documentElement;r.style.setProperty("--main-canvas-width","".concat(n.width,"px")),r.style.setProperty("--main-canvas-height","".concat(n.height,"px")),r.style.setProperty("--final-canvas-size","".concat(t,"px"))},generate:function(){jt(Number(this.cutoutsRatio)),Pt();var t=0;while(-2!==t)console.log(t),t=St(1)},generateImage:function(){var t=document.getElementById("canvas"),e=document.getElementById("imageCanvas"),n=e.getContext("2d");n.resetTransform(),n.fillStyle="#ffffff",n.fillRect(0,0,e.width,e.height);var r=e.width/(2*t.height);n.scale(r,r);var a=e.width/r/2-t.width/2,i=a+t.width;n.lineWidth=2,n.fillStyle="#dedede",n.strokeStyle="#eeeeee",n.beginPath(),n.moveTo(a,0),n.lineTo(i,0),n.lineTo(a+t.width/2,t.height),n.closePath(),n.fill(),n.stroke(),n.drawImage(t,a,0),n.strokeStyle="#000000",n.setLineDash([10,10]),n.beginPath(),n.moveTo(0,e.width/r),n.lineTo(e.width/r,e.width/r),n.stroke();var o=new I["a"];o.addImage(e.toDataURL("image/jpeg"),0,0,210,297),o.save("snowflake.pdf")}}}),Tt=Rt,Et=(n("034f"),n("2877")),It=Object(Et["a"])(Tt,T,E,!1,null,null,null),Ct=It.exports;R["a"].config.productionTip=!1,new R["a"]({render:function(t){return t(Ct)}}).$mount("#app")}});
//# sourceMappingURL=app.1c5b338d.js.map